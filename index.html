<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üè≠ Asset Management System - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Prompt', sans-serif;
        }

        :root {
            --primary: #14b8a6;
            --primary-dark: #0d9488;
            --primary-light: #5eead4;
            --secondary: #06b6d4;
            --accent: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --success: #10b981;
            --info: #06b6d4;
        }

        body {
            background: #f0f9f9;
            overflow-x: hidden;
        }

        /* ========================================
           SIDEBAR MENU
           ======================================== */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 260px;
            height: 100vh;
            background: linear-gradient(180deg, var(--primary) 0%, var(--primary-dark) 100%);
            padding: 20px 0;
            overflow-y: auto;
            z-index: 1000;
            transition: all 0.3s;
            box-shadow: 3px 0 10px rgba(0,0,0,0.1);
        }

        .sidebar.collapsed {
            width: 70px;
        }

        .sidebar.mobile-hidden {
            transform: translateX(-100%);
        }

        .logo {
            color: white;
            font-size: 20px;
            font-weight: bold;
            margin: 0 20px 30px;
            display: flex;
            align-items: center;
            gap: 12px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(255,255,255,0.2);
        }

        .logo i {
            font-size: 28px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }

        .sidebar.collapsed .logo span {
            display: none;
        }

        .menu-items {
            padding: 0 10px;
        }

        .menu-item {
            color: rgba(255,255,255,0.8);
            padding: 15px 20px;
            margin-bottom: 5px;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 15px;
            transition: all 0.3s;
            text-decoration: none;
        }

        .menu-item:hover {
            background: rgba(255,255,255,0.15);
            color: white;
            transform: translateX(5px);
        }

        .menu-item.active {
            background: white;
            color: var(--primary);
            font-weight: 600;
        }

        .menu-item i {
            font-size: 20px;
            width: 30px;
            text-align: center;
        }

        .sidebar.collapsed .menu-item span {
            display: none;
        }

        /* Tooltip for collapsed menu */
        .menu-item[data-tooltip] {
            position: relative;
        }

        .sidebar.collapsed .menu-item[data-tooltip]:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            left: 100%;
            top: 50%;
            transform: translateY(-50%);
            margin-left: 10px;
            padding: 8px 12px;
            background: rgba(0,0,0,0.9);
            color: white;
            border-radius: 6px;
            white-space: nowrap;
            font-size: 13px;
            z-index: 1001;
            animation: fadeIn 0.2s;
        }

        .sidebar.collapsed .menu-item[data-tooltip]:hover::before {
            content: '';
            position: absolute;
            left: 100%;
            top: 50%;
            transform: translateY(-50%);
            margin-left: 5px;
            border: 5px solid transparent;
            border-right-color: rgba(0,0,0,0.9);
            z-index: 1001;
        }

        .menu-toggle {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .menu-toggle:hover {
            background: rgba(255,255,255,0.35);
            transform: translateX(-50%) scale(1.1);
        }

        /* Mobile Menu Button */
        .mobile-menu-btn {
            display: none;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1001;
            background: var(--primary);
            color: white;
            border: none;
            width: 45px;
            height: 45px;
            border-radius: 10px;
            font-size: 20px;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        /* ========================================
           MAIN CONTENT
           ======================================== */
        .main-content {
            margin-left: 260px;
            padding: 20px;
            min-height: 100vh;
            transition: all 0.3s;
        }

        .sidebar.collapsed + .main-content {
            margin-left: 70px;
        }

        /* Header */
        .header {
            background: white;
            padding: 20px 30px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .header h1 {
            color: #333;
            font-size: 26px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .header-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        /* Page Content */
        .page-content {
            display: none;
        }

        .page-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            display: flex;
            align-items: center;
            gap: 20px;
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            color: white;
        }

        .stat-icon.teal {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
        }

        .stat-icon.green {
            background: linear-gradient(135deg, var(--accent) 0%, #059669 100%);
        }

        .stat-icon.blue {
            background: linear-gradient(135deg, var(--secondary) 0%, #0891b2 100%);
        }

        .stat-icon.orange {
            background: linear-gradient(135deg, var(--warning) 0%, #d97706 100%);
        }

        .stat-icon.red {
            background: linear-gradient(135deg, var(--danger) 0%, #dc2626 100%);
        }

        .stat-info h3 {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .stat-info .number {
            font-size: 32px;
            font-weight: 700;
            color: #333;
        }

        /* Buttons */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
            text-decoration: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, var(--accent) 0%, #059669 100%);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning) 0%, #d97706 100%);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger) 0%, #dc2626 100%);
            color: white;
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        /* Form */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
            font-size: 14px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(20, 184, 166, 0.1);
        }

        /* Table */
        .table-container {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
        }

        thead th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: white;
            font-size: 14px;
        }

        tbody tr {
            border-bottom: 1px solid #e5e7eb;
            transition: all 0.2s;
        }

        tbody tr:hover {
            background: #f9fafb;
        }

        tbody td {
            padding: 15px;
            font-size: 14px;
            color: #333;
        }

        /* Status Badge */
        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            display: inline-block;
        }

        .status-active {
            background: #d1fae5;
            color: #065f46;
        }

        .status-maintenance {
            background: #fef3c7;
            color: #92400e;
        }

        .status-broken {
            background: #fee2e2;
            color: #991b1b;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e5e7eb;
        }

        .modal-header h2 {
            color: var(--primary);
            font-size: 22px;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: #666;
            transition: all 0.3s;
        }

        .close-modal:hover {
            color: var(--danger);
            transform: rotate(90deg);
        }

        /* Charts Container */
        .charts-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .chart-card h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 18px;
        }

        /* Search Box */
        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .search-box input,
        .search-box select {
            padding: 12px 15px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 14px;
        }

        .search-box input {
            flex: 1;
            min-width: 250px;
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--primary);
        }

        /* Loading */
        .loading {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.95);
            z-index: 3000;
            align-items: center;
            justify-content: center;
        }

        .loading.active {
            display: flex;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Font Awesome spin animation */
        .fa-spin {
            animation: spin 1s linear infinite !important;
        }

        /* Refresh button hover effect */
        .btn-secondary:hover .fa-sync-alt:not(.fa-spin) {
            transform: rotate(180deg);
            transition: transform 0.3s ease;
        }

        .btn .fa-sync-alt {
            transition: transform 0.3s ease;
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 20px 25px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            z-index: 4000;
            display: none;
            min-width: 320px;
            max-width: 450px;
        }

        .notification.active {
            display: block;
            animation: slideInRight 0.4s;
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .notification.success {
            border-left: 5px solid var(--accent);
        }

        .notification.error {
            border-left: 5px solid var(--danger);
        }

        .notification.warning {
            border-left: 5px solid var(--warning);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        .empty-state i {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        .empty-state h3 {
            color: #666;
            margin-bottom: 10px;
        }

        /* Section */
        .section {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 20px;
        }

        .section h3 {
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Import Drop Zone */
        .drop-zone {
            border: 3px dashed #cbd5e1;
            border-radius: 15px;
            padding: 60px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: #f9fafb;
        }

        .drop-zone:hover,
        .drop-zone.dragover {
            border-color: var(--primary);
            background: #f0f9f9;
        }

        .drop-zone i {
            font-size: 48px;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .drop-zone p {
            color: #666;
            font-size: 16px;
        }

        /* Progress Bar */
        .progress-bar {
            height: 10px;
            background: #e5e7eb;
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary) 0%, var(--primary-light) 100%);
            transition: width 0.3s;
        }

        /* ========================================
           RESPONSIVE DESIGN
           ======================================== */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.mobile-open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .sidebar.collapsed + .main-content {
                margin-left: 0;
            }

            .mobile-menu-btn {
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .header h1 {
                font-size: 20px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .charts-container {
                grid-template-columns: 1fr;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .search-box {
                flex-direction: column;
            }

            .search-box input,
            .search-box select {
                width: 100%;
            }

            table {
                font-size: 12px;
            }

            thead th,
            tbody td {
                padding: 10px 8px;
            }

            .stat-info .number {
                font-size: 24px;
            }
        }

        /* Hide scrollbar in sidebar */
        .sidebar::-webkit-scrollbar {
            width: 5px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.3);
            border-radius: 10px;
        }

        /* Action Buttons */
        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
            margin-right: 5px;
        }

        .action-edit {
            background: var(--warning);
            color: white;
        }

        .action-delete {
            background: var(--danger);
            color: white;
        }

        .action-btn:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <!-- Loading -->
    <div class="loading" id="loading">
        <div class="loading-spinner"></div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <div id="notificationContent"></div>
    </div>

    <!-- Mobile Menu Button -->
    <button class="mobile-menu-btn" id="mobileMenuBtn" onclick="toggleMobileMenu()">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="logo">
            <i class="fas fa-box"></i>
            <span>Asset Manager</span>
        </div>

        <div class="menu-items">
            <div class="menu-item active" onclick="showPage('dashboard')" data-tooltip="Dashboard">
                <i class="fas fa-th-large"></i>
                <span>Dashboard</span>
            </div>
            <div class="menu-item" onclick="showPage('assets')" data-tooltip="‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô">
                <i class="fas fa-boxes"></i>
                <span>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</span>
            </div>
            <div class="menu-item" onclick="showPage('locations')" data-tooltip="‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö">
                <i class="fas fa-warehouse"></i>
                <span>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö</span>
            </div>
            <div class="menu-item" onclick="showPage('departments')" data-tooltip="‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏Å">
                <i class="fas fa-sitemap"></i>
                <span>‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏Å</span>
            </div>
            <div class="menu-item" onclick="showPage('maintenance')" data-tooltip="‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤">
                <i class="fas fa-tools"></i>
                <span>‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤</span>
            </div>
            <div class="menu-item" onclick="showPage('reports')" data-tooltip="‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô">
                <i class="fas fa-chart-pie"></i>
                <span>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</span>
            </div>
        </div>

        <button class="menu-toggle" onclick="toggleSidebar()">
            <i class="fas fa-angle-left"></i>
        </button>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- ========================================
             DASHBOARD PAGE
             ======================================== -->
        <div class="page-content active" id="dashboard">
            <div class="header">
                <h1>
                    <i class="fas fa-th-large"></i>
                    Dashboard
                </h1>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="refreshData()">
                        <i class="fas fa-sync-alt"></i> ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä
                    </button>
                </div>
            </div>

            <!-- Stats Cards -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon teal">
                        <i class="fas fa-boxes"></i>
                    </div>
                    <div class="stat-info">
                        <h3>‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                        <div class="number" id="totalAssets">0</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon green">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-info">
                        <h3>‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</h3>
                        <div class="number" id="activeAssets">0</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon blue">
                        <i class="fas fa-wrench"></i>
                    </div>
                    <div class="stat-info">
                        <h3>‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°</h3>
                        <div class="number" id="maintenanceAssets">0</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon orange">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="stat-info">
                        <h3>‡∏ä‡∏≥‡∏£‡∏∏‡∏î/‡πÄ‡∏™‡∏µ‡∏¢</h3>
                        <div class="number" id="brokenAssets">0</div>
                    </div>
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="section">
                <h3><i class="fas fa-chart-pie"></i> ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏ß‡∏°</h3>
                <div class="charts-container">
                    <div class="chart-card">
                        <h4 style="margin-bottom: 15px; color: #666;">
                            <i class="fas fa-chart-doughnut"></i> ‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô
                        </h4>
                        <canvas id="statusChart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h4 style="margin-bottom: 15px; color: #666;">
                            <i class="fas fa-chart-bar"></i> ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏Å
                        </h4>
                        <canvas id="departmentChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="section">
                <h3><i class="fas fa-clock"></i> ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>
                <div id="recentActivity">
                    <div class="empty-state">
                        <i class="fas fa-history"></i>
                        <h3>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h3>
                        <p>‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ========================================
             ASSETS PAGE
             ======================================== -->
        <div class="page-content" id="assets">
            <div class="header">
                <h1>
                    <i class="fas fa-boxes"></i>
                    ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô
                </h1>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="refreshData()">
                        <i class="fas fa-sync-alt"></i> ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä
                    </button>
                    <button class="btn btn-success" onclick="openImportModal()">
                        <i class="fas fa-file-excel"></i> Import Excel
                    </button>
                    <button class="btn btn-primary" onclick="openAssetModal()">
                        <i class="fas fa-plus"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô
                    </button>
                </div>
            </div>

            <div class="search-box">
                <input type="text" id="searchAsset" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô, ‡∏ä‡∏∑‡πà‡∏≠..." oninput="filterAssets()">
                <select id="filterCategory" onchange="filterAssets()">
                    <option value="">‡∏ó‡∏∏‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</option>
                </select>
                <select id="filterLocation" onchange="filterAssets()">
                    <option value="">‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</option>
                </select>
                <select id="filterStatus" onchange="filterAssets()">
                    <option value="">‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
                    <option value="‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥">‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥</option>
                    <option value="‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á">‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á</option>
                    <option value="‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏™‡∏†‡∏≤‡∏û">‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏™‡∏†‡∏≤‡∏û</option>
                </select>
            </div>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</th>
                            <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</th>
                            <th>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</th>
                            <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</th>
                            <th>‡πÅ‡∏ú‡∏ô‡∏Å</th>
                            <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                            <th>‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</th>
                            <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                        </tr>
                    </thead>
                    <tbody id="assetsTableBody">
                        <tr>
                            <td colspan="9" class="empty-state">
                                <i class="fas fa-box-open"></i>
                                <h3>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</h3>
                                <p>‡∏Ñ‡∏•‡∏¥‡∏Å "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô" ‡∏´‡∏£‡∏∑‡∏≠ "Import Excel" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- ========================================
             LOCATIONS PAGE
             ======================================== -->
        <div class="page-content" id="locations">
            <div class="header">
                <h1>
                    <i class="fas fa-warehouse"></i>
                    ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô
                </h1>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="refreshData()">
                        <i class="fas fa-sync-alt"></i> ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä
                    </button>
                    <button class="btn btn-success" onclick="openLocationModal()">
                        <i class="fas fa-plus"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà
                    </button>
                </div>
            </div>

            <!-- Location Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon teal">
                        <i class="fas fa-warehouse"></i>
                    </div>
                    <div class="stat-info">
                        <h3>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                        <div class="number" id="totalLocations">0</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon blue">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="stat-info">
                        <h3>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</h3>
                        <div class="number" id="avgCapacity">0%</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon green">
                        <i class="fas fa-boxes"></i>
                    </div>
                    <div class="stat-info">
                        <h3>‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                        <div class="number" id="totalAssetsInLocations">0</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon orange">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="stat-info">
                        <h3>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ï‡πá‡∏° (>90%)</h3>
                        <div class="number" id="fullLocations">0</div>
                    </div>
                </div>
            </div>

            <div class="search-box">
                <input type="text" id="searchLocation" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà..." oninput="filterLocations()">
            </div>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</th>
                            <th>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∏‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</th>
                            <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</th>
                            <th>% ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∏</th>
                            <th>‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</th>
                            <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                        </tr>
                    </thead>
                    <tbody id="locationsTableBody">
                        <tr>
                            <td colspan="7" class="empty-state">
                                <i class="fas fa-map-marker-alt"></i>
                                <h3>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</h3>
                                <p>‡∏Ñ‡∏•‡∏¥‡∏Å "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- ========================================
             DEPARTMENTS PAGE
             ======================================== -->
        <div class="page-content" id="departments">
            <div class="header">
                <h1>
                    <i class="fas fa-sitemap"></i>
                    ‡πÅ‡∏¢‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏Å
                </h1>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="refreshDepartments()">
                        <i class="fas fa-sync-alt"></i> ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä
                    </button>
                    <button class="btn btn-success" onclick="exportDepartmentReport()">
                        <i class="fas fa-download"></i> Export ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
                    </button>
                </div>
            </div>

            <!-- Department Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon teal">
                        <i class="fas fa-sitemap"></i>
                    </div>
                    <div class="stat-info">
                        <h3>‡πÅ‡∏ú‡∏ô‡∏Å‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</h3>
                        <div class="number" id="totalDepartments">0</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon green">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-info">
                        <h3>‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                        <div class="number" id="deptActiveTotal">0</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon orange">
                        <i class="fas fa-wrench"></i>
                    </div>
                    <div class="stat-info">
                        <h3>‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                        <div class="number" id="deptMaintenanceTotal">0</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon red">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="stat-info">
                        <h3>‡∏ä‡∏≥‡∏£‡∏∏‡∏î/‡πÄ‡∏™‡∏µ‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                        <div class="number" id="deptBrokenTotal">0</div>
                    </div>
                </div>
            </div>

            <!-- Charts -->
            <div class="section">
                <h3><i class="fas fa-chart-bar"></i> ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏ú‡∏ô‡∏Å</h3>
                <canvas id="departmentBarChart"></canvas>
            </div>

            <div class="charts-container">
                <div class="chart-card">
                    <h3><i class="fas fa-chart-pie"></i> ‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏Å</h3>
                    <canvas id="departmentPieChart"></canvas>
                </div>
                <div class="chart-card">
                    <h3><i class="fas fa-info-circle"></i> ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏ú‡∏ô‡∏Å</h3>
                    <div id="departmentDetails" style="max-height: 300px; overflow-y: auto;">
                        <div class="empty-state">
                            <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Department Table -->
            <div class="section">
                <h3><i class="fas fa-table"></i> ‡∏™‡∏£‡∏∏‡∏õ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏Å‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>‡πÅ‡∏ú‡∏ô‡∏Å</th>
                                <th>‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</th>
                                <th>‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°</th>
                                <th>‡∏ä‡∏≥‡∏£‡∏∏‡∏î</th>
                                <th>‡πÄ‡∏™‡∏µ‡∏¢</th>
                                <th>‡∏£‡∏ß‡∏°</th>
                                <th>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="departmentTableBody">
                            <tr>
                                <td colspan="7" class="empty-state">
                                    <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ========================================
             MAINTENANCE PAGE
             ======================================== -->
        <div class="page-content" id="maintenance">
            <div class="header">
                <h1>
                    <i class="fas fa-tools"></i>
                    ‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤
                </h1>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="refreshMaintenance()">
                        <i class="fas fa-sync-alt"></i> ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä
                    </button>
                </div>
            </div>

            <!-- Maintenance Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon orange">
                        <i class="fas fa-clipboard-list"></i>
                    </div>
                    <div class="stat-info">
                        <h3>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°</h3>
                        <div class="number" id="maintenanceCount">0</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon blue">
                        <i class="fas fa-cog fa-spin"></i>
                    </div>
                    <div class="stat-info">
                        <h3>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</h3>
                        <div class="number" id="inProgressCount">0</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon green">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-info">
                        <h3>‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</h3>
                        <div class="number" id="completedCount">0</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon teal">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <div class="stat-info">
                        <h3>‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£</h3>
                        <div class="number" id="estimatedCost">‡∏ø0</div>
                    </div>
                </div>
            </div>

            <!-- Maintenance Table -->
            <div class="section">
                <h3><i class="fas fa-list-alt"></i> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</th>
                                <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</th>
                                <th>‡πÅ‡∏ú‡∏ô‡∏Å</th>
                                <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="maintenanceTableBody">
                            <tr>
                                <td colspan="7" class="empty-state">
                                    <i class="fas fa-tools"></i>
                                    <h3>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á</h3>
                                    <p>‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ "‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á" ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ========================================
             REPORTS PAGE
             ======================================== -->
        <div class="page-content" id="reports">
            <div class="header">
                <h1>
                    <i class="fas fa-chart-pie"></i>
                    ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
                </h1>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="refreshData()">
                        <i class="fas fa-sync-alt"></i> ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä
                    </button>
                </div>
            </div>

            <!-- Summary Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon teal">
                        <i class="fas fa-boxes"></i>
                    </div>
                    <div class="stat-info">
                        <h3>‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                        <div class="number" id="reportTotalAssets">0</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon green">
                        <i class="fas fa-sitemap"></i>
                    </div>
                    <div class="stat-info">
                        <h3>‡πÅ‡∏ú‡∏ô‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                        <div class="number" id="reportTotalDepartments">0</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon blue">
                        <i class="fas fa-warehouse"></i>
                    </div>
                    <div class="stat-info">
                        <h3>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                        <div class="number" id="reportTotalLocations">0</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon orange">
                        <i class="fas fa-tags"></i>
                    </div>
                    <div class="stat-info">
                        <h3>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                        <div class="number" id="reportTotalCategories">0</div>
                    </div>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="section">
                <h3><i class="fas fa-chart-line"></i> ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</h3>
                <div class="charts-container">
                    <div class="chart-card">
                        <h4 style="margin-bottom: 15px; color: #666;">
                            <i class="fas fa-chart-pie"></i> ‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô
                        </h4>
                        <canvas id="reportStatusChart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h4 style="margin-bottom: 15px; color: #666;">
                            <i class="fas fa-chart-bar"></i> ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà
                        </h4>
                        <canvas id="reportCategoryChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Department & Location Charts -->
            <div class="section">
                <h3><i class="fas fa-chart-area"></i> ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏Ç‡∏≠‡∏á‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</h3>
                <div class="charts-container">
                    <div class="chart-card">
                        <h4 style="margin-bottom: 15px; color: #666;">
                            <i class="fas fa-sitemap"></i> ‡πÅ‡∏ú‡∏ô‡∏Å‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (Top 10)
                        </h4>
                        <canvas id="reportDepartmentChart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h4 style="margin-bottom: 15px; color: #666;">
                            <i class="fas fa-warehouse"></i> ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (Top 10)
                        </h4>
                        <canvas id="reportLocationChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Value Analysis -->
            <div class="section">
                <h3><i class="fas fa-dollar-sign"></i> ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤</h3>
                <div class="charts-container">
                    <div class="chart-card">
                        <h4 style="margin-bottom: 15px; color: #666;">
                            <i class="fas fa-chart-line"></i> ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏Å
                        </h4>
                        <canvas id="reportValueByDeptChart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h4 style="margin-bottom: 15px; color: #666;">
                            <i class="fas fa-coins"></i> ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏£‡∏ß‡∏°‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
                        </h4>
                        <canvas id="reportValueByStatusChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Capacity Analysis -->
            <div class="section">
                <h3><i class="fas fa-layer-group"></i> ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∏‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</h3>
                <div class="chart-card" style="max-width: 100%;">
                    <h4 style="margin-bottom: 15px; color: #666;">
                        <i class="fas fa-signal"></i> ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà (%)
                    </h4>
                    <canvas id="reportCapacityChart"></canvas>
                </div>
            </div>

            <!-- Export Section -->
            <div class="section">
                <h3><i class="fas fa-download"></i> Export ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 20px;">
                    <button class="btn btn-success" onclick="exportAssetsReport()" style="padding: 20px; justify-content: center;">
                        <i class="fas fa-file-excel"></i> Export ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                    </button>
                    <button class="btn btn-primary" onclick="exportLocationReport()" style="padding: 20px; justify-content: center;">
                        <i class="fas fa-file-excel"></i> Export ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà
                    </button>
                    <button class="btn btn-warning" onclick="exportMaintenanceReport()" style="padding: 20px; justify-content: center;">
                        <i class="fas fa-file-excel"></i> Export ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á
                    </button>
                    <button class="btn btn-secondary" onclick="exportDepartmentReport()" style="padding: 20px; justify-content: center;">
                        <i class="fas fa-file-excel"></i> Export ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏Å
                    </button>
                </div>
            </div>
        </div>

        <!-- ========================================
             REPORTS PAGE
             ======================================== -->
        <div class="page-content" id="reports">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="assetModalTitle">
                    <i class="fas fa-plus"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà
                </h2>
                <button class="close-modal" onclick="closeAssetModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <form id="assetForm" onsubmit="saveAssetForm(event)">
                <div class="form-grid">
                    <div class="form-group">
                        <label><i class="fas fa-barcode"></i> ‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô *</label>
                        <input type="text" id="assetCode" required>
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-tag"></i> ‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô *</label>
                        <input type="text" id="assetName" required>
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-th-large"></i> ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
                        <input type="text" id="category">
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-copyright"></i> ‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠</label>
                        <input type="text" id="brand">
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-cube"></i> ‡∏£‡∏∏‡πà‡∏ô</label>
                        <input type="text" id="model">
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-hashtag"></i> Serial Number</label>
                        <input type="text" id="serial">
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-calendar"></i> ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤</label>
                        <input type="date" id="receivedDate">
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-dollar-sign"></i> ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠</label>
                        <input type="number" id="price" step="0.01">
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-map-marker-alt"></i> ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö</label>
                        <select id="location">
                            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-building"></i> ‡πÅ‡∏ú‡∏ô‡∏Å</label>
                        <input type="text" id="department">
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-info-circle"></i> ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                        <select id="status">
                            <option value="‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥">‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥</option>
                            <option value="‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á">‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á</option>
                            <option value="‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏™‡∏†‡∏≤‡∏û">‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏™‡∏†‡∏≤‡∏û</option>
                        </select>
                    </div>
                    <div class="form-group" style="grid-column: span 2;">
                        <label><i class="fas fa-comment"></i> ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</label>
                        <textarea id="description" style="min-height: 80px;"></textarea>
                    </div>
                </div>

                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                    <button type="button" class="btn btn-secondary" onclick="closeAssetModal()">
                        <i class="fas fa-times"></i> ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Location Modal -->
    <div class="modal" id="locationModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="locationModalTitle">
                    <i class="fas fa-plus"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡∏°‡πà
                </h2>
                <button class="close-modal" onclick="closeLocationModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <form id="locationForm" onsubmit="saveLocationForm(event)">
                <div class="form-grid">
                    <div class="form-group">
                        <label><i class="fas fa-map-marker-alt"></i> ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà *</label>
                        <input type="text" id="locationName" required>
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-layer-group"></i> ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∏‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</label>
                        <input type="number" id="maxCapacity">
                    </div>
                    <div class="form-group" style="grid-column: span 2;">
                        <label><i class="fas fa-edit"></i> ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏≠‡∏á</label>
                        <textarea id="customData" style="min-height: 80px;"></textarea>
                    </div>
                </div>

                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                    <button type="button" class="btn btn-secondary" onclick="closeLocationModal()">
                        <i class="fas fa-times"></i> ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-save"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Import Modal -->
    <div class="modal" id="importModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>
                    <i class="fas fa-file-excel"></i> Import ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Excel
                </h2>
                <button class="close-modal" onclick="closeImportModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="drop-zone" id="dropZone" onclick="document.getElementById('excelFile').click()">
                <i class="fas fa-cloud-upload-alt"></i>
                <p>‡∏Ñ‡∏•‡∏¥‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</p>
                <p style="font-size: 12px; color: #999; margin-top: 10px;">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå .xlsx, .xls</p>
                <input type="file" id="excelFile" accept=".xlsx,.xls" style="display: none;" onchange="handleFileSelect(event)">
            </div>

            <div id="importProgress" style="display: none; margin-top: 20px;">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
                </div>
                <p style="text-align: center; margin-top: 10px; color: #666;" id="progressText">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...</p>
            </div>

            <div style="margin-top: 20px; padding: 15px; background: #f0f9f9; border-radius: 8px;">
                <h4 style="color: var(--primary); margin-bottom: 10px;">
                    <i class="fas fa-info-circle"></i> ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÑ‡∏ü‡∏•‡πå Excel
                </h4>
                <p style="font-size: 14px; color: #666; line-height: 1.8;">
                    ‡πÑ‡∏ü‡∏•‡πå Excel ‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö: <br>
                    <strong>‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô | ‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô | ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà | ‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠ | ‡∏£‡∏∏‡πà‡∏ô | Serial Number | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤ | ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠ | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö | ‡πÅ‡∏ú‡∏ô‡∏Å | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</strong>
                </p>
                <button class="btn btn-secondary" style="margin-top: 10px;" onclick="downloadTemplate()">
                    <i class="fas fa-download"></i> ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î Template
                </button>
            </div>
        </div>
    </div>

    <script>
        // ========================================
        // GLOBAL VARIABLES
        // ========================================

        // üîß URL ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£ Deploy Web App
        let webAppUrl = 'https://script.google.com/macros/s/AKfycbzta9Rzcxf8_qoNKqUcTF-3T2nABQysnkuiSUyGQdjuWI9DKHJBoTrHWCRNVcIQVloXfg/exec';

        let assetsData = [];
        let locationsData = [];
        let filteredAssets = [];
        let filteredLocations = [];
        let currentEditingAsset = null;
        let currentEditingLocation = null;
        let charts = {};

        // ========================================
        // INITIALIZATION
        // ========================================
        window.addEventListener('load', async function() {
            console.log('üöÄ Loading system...');
            console.log('üì° Web App URL:', webAppUrl);
            
            // ‡∏•‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÄ‡∏ä‡πá‡∏Ñ‡∏ó‡∏¥‡πâ‡∏á - ‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏µ‡∏Å‡∏ï‡πà‡∏≠‡πÑ‡∏õ
            
            await loadAllData();
            updateAllPages();
            initCharts();
        });

        // ========================================
        // NAVIGATION
        // ========================================
        function showPage(pageName) {
            // Hide all pages
            document.querySelectorAll('.page-content').forEach(page => {
                page.classList.remove('active');
            });

            // Remove active from all menu items
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });

            // Show selected page
            document.getElementById(pageName).classList.add('active');

            // Add active to clicked menu item
            event.target.classList.add('active');

            // Close mobile menu
            closeMobileMenu();

            // Update page-specific data
            updatePageData(pageName);
        }

        function updatePageData(pageName) {
            switch(pageName) {
                case 'dashboard':
                    updateDashboard();
                    break;
                case 'assets':
                    renderAssets();
                    break;
                case 'locations':
                    updateLocationStats();
                    renderLocations();
                    break;
                case 'departments':
                    updateDepartmentPage();
                    break;
                case 'maintenance':
                    updateMaintenancePage();
                    break;
                case 'reports':
                    updateReportsPage();
                    break;
            }
        }

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('collapsed');
        }

        function toggleMobileMenu() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('mobile-open');
            sidebar.classList.toggle('mobile-hidden');
        }

        function closeMobileMenu() {
            if (window.innerWidth <= 768) {
                const sidebar = document.getElementById('sidebar');
                sidebar.classList.remove('mobile-open');
                sidebar.classList.add('mobile-hidden');
            }
        }

        // ========================================
        // DATA LOADING
        // ========================================
        async function loadAllData() {
            if (!webAppUrl) {
                console.log('‚ö†Ô∏è Web App URL not configured');
                // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô array ‡∏ß‡πà‡∏≤‡∏á
                assetsData = [];
                filteredAssets = [];
                locationsData = [];
                filteredLocations = [];
                return;
            }

            console.log('üîÑ Loading all data from:', webAppUrl);
            
            try {
                await Promise.all([
                    loadAssets(),
                    loadLocations()
                ]);
                
                console.log('‚úÖ All data loaded successfully');
                console.log('   Assets:', assetsData.length);
                console.log('   Locations:', locationsData.length);
            } catch (error) {
                console.error('‚ùå Error in loadAllData:', error);
                // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô array ‡∏ß‡πà‡∏≤‡∏á
                assetsData = [];
                filteredAssets = [];
                locationsData = [];
                filteredLocations = [];
            }
        }

        async function loadAssets() {
            try {
                showLoading();
                const response = await fetch(webAppUrl + '?action=getAssets');
                const result = await response.json();
                
                console.log('üì¶ Assets Response:', result);
                
                if (result.success) {
                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ data ‡πÄ‡∏õ‡πá‡∏ô array ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                    if (result.data && Array.isArray(result.data)) {
                        assetsData = result.data;
                        filteredAssets = [...assetsData];
                        console.log('‚úÖ Loaded', assetsData.length, 'assets');
                    } else {
                        // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà array ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô array ‡∏ß‡πà‡∏≤‡∏á
                        assetsData = [];
                        filteredAssets = [];
                        console.log('‚ö†Ô∏è Assets data is not an array, using empty array');
                    }
                } else {
                    // ‡∏Å‡∏£‡∏ì‡∏µ success = false ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
                    assetsData = [];
                    filteredAssets = [];
                    console.log('‚ö†Ô∏è API returned success=false:', result.message);
                }
            } catch (error) {
                console.error('‚ùå Error loading assets:', error);
                // ‡∏Å‡∏£‡∏ì‡∏µ error ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô array ‡∏ß‡πà‡∏≤‡∏á
                assetsData = [];
                filteredAssets = [];
                showNotification('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡πÑ‡∏î‡πâ: ' + error.message, 'warning');
            } finally {
                hideLoading();
            }
        }

        async function loadLocations() {
            try {
                const response = await fetch(webAppUrl + '?action=getLocations');
                const result = await response.json();
                
                console.log('üìç Locations Response:', result);
                
                if (result.success) {
                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ data ‡πÄ‡∏õ‡πá‡∏ô array ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                    if (result.data && Array.isArray(result.data)) {
                        locationsData = result.data;
                        filteredLocations = [...locationsData];
                        console.log('‚úÖ Loaded', locationsData.length, 'locations');
                        updateLocationDropdowns();
                    } else {
                        // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà array ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô array ‡∏ß‡πà‡∏≤‡∏á
                        locationsData = [];
                        filteredLocations = [];
                        console.log('‚ö†Ô∏è Locations data is not an array, using empty array');
                    }
                } else {
                    // ‡∏Å‡∏£‡∏ì‡∏µ success = false ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
                    locationsData = [];
                    filteredLocations = [];
                    console.log('‚ö†Ô∏è API returned success=false:', result.message);
                }
            } catch (error) {
                console.error('‚ùå Error loading locations:', error);
                // ‡∏Å‡∏£‡∏ì‡∏µ error ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô array ‡∏ß‡πà‡∏≤‡∏á
                locationsData = [];
                filteredLocations = [];
                showNotification('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ: ' + error.message, 'warning');
            }
        }

        async function refreshData() {
            console.log('üîÑ Refreshing all data...');
            
            // ‡πÅ‡∏™‡∏î‡∏á loading
            showLoading();
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏´‡∏°‡∏∏‡∏ô‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            const refreshButtons = document.querySelectorAll('.btn-secondary .fa-sync-alt');
            refreshButtons.forEach(btn => {
                btn.classList.add('fa-spin');
            });
            
            try {
                // ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ß‡πà‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î
                showNotification('üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets...', 'success');
                
                // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà
                await loadAllData();
                
                // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                updateAllPages();
                
                // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
                showNotification('‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô: ' + assetsData.length + ' | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà: ' + locationsData.length, 'success');
                
                console.log('‚úÖ Data refreshed successfully');
                console.log('   üì¶ Assets:', assetsData.length);
                console.log('   üìç Locations:', locationsData.length);
                
            } catch (error) {
                console.error('‚ùå Error refreshing data:', error);
                showNotification('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ' + error.message, 'error');
            } finally {
                // ‡∏ã‡πà‡∏≠‡∏ô loading
                hideLoading();
                
                // ‡∏•‡∏ö‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏´‡∏°‡∏∏‡∏ô
                setTimeout(() => {
                    refreshButtons.forEach(btn => {
                        btn.classList.remove('fa-spin');
                    });
                }, 500);
            }
        }

        function updateAllPages() {
            updateDashboard();
            renderAssets();
            updateLocationStats();
            renderLocations();
            updateDepartmentPage();
            updateMaintenancePage();
            updateReportsPage();
            updateFilters();
        }

        // ========================================
        // DASHBOARD
        // ========================================
        function updateDashboard() {
            // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ assetsData ‡πÄ‡∏õ‡πá‡∏ô array ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
            if (!Array.isArray(assetsData)) {
                console.error('‚ùå assetsData is not an array:', assetsData);
                assetsData = [];
            }

            // Update stats
            document.getElementById('totalAssets').textContent = assetsData.length;
            
            const activeAssets = assetsData.filter(a => a.status === '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥').length;
            const maintenanceAssets = assetsData.filter(a => a.status === '‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á').length;
            const brokenAssets = assetsData.filter(a => a.status === '‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏™‡∏†‡∏≤‡∏û').length;
            
            document.getElementById('activeAssets').textContent = activeAssets;
            document.getElementById('maintenanceAssets').textContent = maintenanceAssets;
            document.getElementById('brokenAssets').textContent = brokenAssets;

            // Update charts
            updateDashboardCharts();
        }

        // ========================================
        // CHARTS
        // ========================================
        function initCharts() {
            // Status Chart
            const statusCtx = document.getElementById('statusChart');
            if (statusCtx) {
                charts.status = new Chart(statusCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥', '‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á', '‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏™‡∏†‡∏≤‡∏û'],
                        datasets: [{
                            data: [0, 0, 0],
                            backgroundColor: ['#10b981', '#06b6d4', '#f59e0b']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }

            // Department Chart
            const deptCtx = document.getElementById('departmentChart');
            if (deptCtx) {
                charts.department = new Chart(deptCtx, {
                    type: 'bar',
                    data: {
                        labels: [],
                        datasets: [{
                            label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô',
                            data: [],
                            backgroundColor: '#14b8a6'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
        }

        function updateDashboardCharts() {
            // Update Status Chart
            if (charts.status) {
                const active = assetsData.filter(a => a.status === '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥').length;
                const maintenance = assetsData.filter(a => a.status === '‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á').length;
                const broken = assetsData.filter(a => a.status === '‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏™‡∏†‡∏≤‡∏û').length;
                
                charts.status.data.datasets[0].data = [active, maintenance, broken];
                charts.status.update();
            }

            // Update Department Chart
            if (charts.department) {
                const deptCounts = {};
                assetsData.forEach(asset => {
                    if (asset.department) {
                        deptCounts[asset.department] = (deptCounts[asset.department] || 0) + 1;
                    }
                });
                
                charts.department.data.labels = Object.keys(deptCounts);
                charts.department.data.datasets[0].data = Object.values(deptCounts);
                charts.department.update();
            }
        }

        // ========================================
        // ASSETS MANAGEMENT
        // ========================================
        function renderAssets() {
            const tbody = document.getElementById('assetsTableBody');
            
            if (filteredAssets.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="9" class="empty-state">
                            <i class="fas fa-box-open"></i>
                            <h3>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</h3>
                            <p>‡∏•‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏≠‡∏∑‡πà‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà</p>
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = filteredAssets.map((asset, index) => {
                const statusClass = asset.status === '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥' ? 'status-active' : 
                                   asset.status === '‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á' ? 'status-maintenance' : 'status-broken';
                
                return `
                    <tr>
                        <td>${index + 1}</td>
                        <td><strong>${asset.assetCode}</strong></td>
                        <td>${asset.assetName}</td>
                        <td>${asset.category || '-'}</td>
                        <td><i class="fas fa-map-marker-alt"></i> ${asset.location || '-'}</td>
                        <td>${asset.department || '-'}</td>
                        <td><span class="status-badge ${statusClass}">${asset.status}</span></td>
                        <td>${formatDateTime(asset.lastUpdate)}</td>
                        <td>
                            <button class="action-btn action-edit" onclick='editAsset(${JSON.stringify(asset).replace(/'/g, "&#39;")})'>
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn action-delete" onclick="deleteAsset('${asset.assetCode}')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function filterAssets() {
            const searchTerm = document.getElementById('searchAsset').value.toLowerCase();
            const categoryFilter = document.getElementById('filterCategory').value;
            const locationFilter = document.getElementById('filterLocation').value;
            const statusFilter = document.getElementById('filterStatus').value;

            filteredAssets = assetsData.filter(asset => {
                const matchSearch = !searchTerm || 
                    asset.assetCode.toLowerCase().includes(searchTerm) ||
                    asset.assetName.toLowerCase().includes(searchTerm);
                
                const matchCategory = !categoryFilter || asset.category === categoryFilter;
                const matchLocation = !locationFilter || asset.location === locationFilter;
                const matchStatus = !statusFilter || asset.status === statusFilter;

                return matchSearch && matchCategory && matchLocation && matchStatus;
            });

            renderAssets();
        }

        function updateFilters() {
            // Update category filter
            const categories = [...new Set(assetsData.map(a => a.category).filter(Boolean))];
            const categoryFilter = document.getElementById('filterCategory');
            if (categoryFilter) {
                categoryFilter.innerHTML = '<option value="">‡∏ó‡∏∏‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</option>' +
                    categories.map(cat => `<option value="${cat}">${cat}</option>`).join('');
            }

            // Update location filter
            const locations = [...new Set(assetsData.map(a => a.location).filter(Boolean))];
            const locationFilter = document.getElementById('filterLocation');
            if (locationFilter) {
                locationFilter.innerHTML = '<option value="">‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</option>' +
                    locations.map(loc => `<option value="${loc}">${loc}</option>`).join('');
            }
        }

        function updateLocationDropdowns() {
            const locationSelect = document.getElementById('location');
            if (locationSelect) {
                locationSelect.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà --</option>' +
                    locationsData.map(loc => `<option value="${loc.name}">${loc.name}</option>`).join('');
            }
        }

        // ========================================
        // ASSET MODAL
        // ========================================
        function openAssetModal() {
            currentEditingAsset = null;
            document.getElementById('assetModalTitle').innerHTML = '<i class="fas fa-plus"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà';
            document.getElementById('assetForm').reset();
            document.getElementById('assetCode').disabled = false;
            document.getElementById('assetModal').classList.add('active');
        }

        function editAsset(asset) {
            currentEditingAsset = asset;
            document.getElementById('assetModalTitle').innerHTML = '<i class="fas fa-edit"></i> ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô';
            
            document.getElementById('assetCode').value = asset.assetCode;
            document.getElementById('assetCode').disabled = true;
            document.getElementById('assetName').value = asset.assetName;
            document.getElementById('category').value = asset.category || '';
            document.getElementById('brand').value = asset.brand || '';
            document.getElementById('model').value = asset.model || '';
            document.getElementById('serial').value = asset.serial || '';
            document.getElementById('receivedDate').value = asset.receivedDate || '';
            document.getElementById('price').value = asset.price || '';
            document.getElementById('location').value = asset.location || '';
            document.getElementById('department').value = asset.department || '';
            document.getElementById('status').value = asset.status || '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥';
            document.getElementById('description').value = asset.description || '';
            
            document.getElementById('assetModal').classList.add('active');
        }

        function closeAssetModal() {
            document.getElementById('assetModal').classList.remove('active');
            document.getElementById('assetForm').reset();
            currentEditingAsset = null;
        }

        async function saveAssetForm(event) {
            event.preventDefault();

            if (!webAppUrl) {
                showNotification('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Web App URL ‡∏Å‡πà‡∏≠‡∏ô', 'warning');
                return;
            }

            const formData = {
                assetCode: document.getElementById('assetCode').value,
                assetName: document.getElementById('assetName').value,
                category: document.getElementById('category').value,
                brand: document.getElementById('brand').value,
                model: document.getElementById('model').value,
                serial: document.getElementById('serial').value,
                receivedDate: document.getElementById('receivedDate').value,
                price: document.getElementById('price').value,
                location: document.getElementById('location').value,
                department: document.getElementById('department').value,
                status: document.getElementById('status').value,
                description: document.getElementById('description').value
            };

            showLoading();

            try {
                const action = currentEditingAsset ? 'updateAsset' : 'saveAsset';
                
                const response = await fetch(webAppUrl, {
                    method: 'POST',
                    body: JSON.stringify({
                        action: action,
                        ...formData
                    })
                });

                const result = await response.json();

                if (result.success) {
                    showNotification('‚úÖ ' + result.message, 'success');
                    closeAssetModal();
                    await loadAllData();
                    updateAllPages();
                } else {
                    showNotification('‚ùå ' + result.message, 'error');
                }
            } catch (error) {
                console.error('Error saving asset:', error);
                showNotification('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message, 'error');
            }

            hideLoading();
        }

        async function deleteAsset(assetCode) {
            if (!confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô "' + assetCode + '" ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                return;
            }

            showLoading();

            try {
                const response = await fetch(webAppUrl, {
                    method: 'POST',
                    body: JSON.stringify({
                        action: 'deleteAsset',
                        assetCode: assetCode
                    })
                });

                const result = await response.json();

                if (result.success) {
                    showNotification('‚úÖ ‡∏•‡∏ö‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
                    await loadAllData();
                    updateAllPages();
                } else {
                    showNotification('‚ùå ' + result.message, 'error');
                }
            } catch (error) {
                console.error('Error deleting asset:', error);
                showNotification('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message, 'error');
            }

            hideLoading();
        }

        // ========================================
        // LOCATION MANAGEMENT
        // ========================================
        function updateLocationStats() {
            document.getElementById('totalLocations').textContent = locationsData.length;
            
            let totalCapacity = 0;
            let totalAssets = 0;
            let fullLocations = 0;
            
            locationsData.forEach(loc => {
                const capacity = parseInt(loc.maxCapacity) || 0;
                const count = parseInt(loc.assetCount) || 0;
                
                if (capacity > 0) {
                    totalCapacity += capacity;
                    totalAssets += count;
                    
                    const percent = (count / capacity) * 100;
                    if (percent > 90) fullLocations++;
                }
            });
            
            const avgPercent = totalCapacity > 0 ? Math.round((totalAssets / totalCapacity) * 100) : 0;
            
            document.getElementById('avgCapacity').textContent = avgPercent + '%';
            document.getElementById('totalAssetsInLocations').textContent = totalAssets;
            document.getElementById('fullLocations').textContent = fullLocations;
        }

        function renderLocations() {
            const tbody = document.getElementById('locationsTableBody');
            
            if (filteredLocations.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" class="empty-state">
                            <i class="fas fa-map-marker-alt"></i>
                            <h3>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</h3>
                            <p>‡∏Ñ‡∏•‡∏¥‡∏Å "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</p>
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = filteredLocations.map((location, index) => {
                const capacity = parseInt(location.maxCapacity) || 0;
                const count = parseInt(location.assetCount) || 0;
                const percent = capacity > 0 ? Math.round((count / capacity) * 100) : 0;
                const percentColor = percent >= 90 ? 'var(--danger)' : percent >= 70 ? 'var(--warning)' : 'var(--accent)';
                
                return `
                    <tr>
                        <td>${index + 1}</td>
                        <td><strong><i class="fas fa-map-marker-alt"></i> ${location.name}</strong></td>
                        <td>${capacity || '-'}</td>
                        <td>${count}</td>
                        <td>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <div style="flex: 1; height: 8px; background: #e5e7eb; border-radius: 10px; overflow: hidden;">
                                    <div style="width: ${percent}%; height: 100%; background: ${percentColor}; transition: width 0.3s;"></div>
                                </div>
                                <strong style="color: ${percentColor}; min-width: 45px;">${percent}%</strong>
                            </div>
                        </td>
                        <td>${formatDateTime(location.lastUpdate)}</td>
                        <td>
                            <button class="action-btn action-edit" onclick='editLocation(${JSON.stringify(location).replace(/'/g, "&#39;")})'>
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn action-delete" onclick="deleteLocation('${location.name}')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function filterLocations() {
            const searchTerm = document.getElementById('searchLocation').value.toLowerCase();
            
            filteredLocations = locationsData.filter(location => {
                return location.name.toLowerCase().includes(searchTerm);
            });

            renderLocations();
        }

        // ========================================
        // LOCATION MODAL
        // ========================================
        function openLocationModal() {
            currentEditingLocation = null;
            document.getElementById('locationModalTitle').innerHTML = '<i class="fas fa-plus"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡∏°‡πà';
            document.getElementById('locationForm').reset();
            document.getElementById('locationName').disabled = false;
            document.getElementById('locationModal').classList.add('active');
        }

        function editLocation(location) {
            currentEditingLocation = location;
            document.getElementById('locationModalTitle').innerHTML = '<i class="fas fa-edit"></i> ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà';
            
            document.getElementById('locationName').value = location.name;
            document.getElementById('locationName').disabled = true;
            document.getElementById('maxCapacity').value = location.maxCapacity || '';
            document.getElementById('customData').value = location.customData || '';
            
            document.getElementById('locationModal').classList.add('active');
        }

        function closeLocationModal() {
            document.getElementById('locationModal').classList.remove('active');
            document.getElementById('locationForm').reset();
            currentEditingLocation = null;
        }

        async function saveLocationForm(event) {
            event.preventDefault();

            if (!webAppUrl) {
                showNotification('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Web App URL ‡∏Å‡πà‡∏≠‡∏ô', 'warning');
                return;
            }

            const formData = {
                location: document.getElementById('locationName').value,
                capacity: document.getElementById('maxCapacity').value,
                custom: document.getElementById('customData').value
            };

            if (currentEditingLocation) {
                formData.oldLocation = currentEditingLocation.name;
            }

            showLoading();

            try {
                const action = currentEditingLocation ? 'updateLocation' : 'saveLocation';
                
                const response = await fetch(webAppUrl, {
                    method: 'POST',
                    body: JSON.stringify({
                        action: action,
                        ...formData
                    })
                });

                const result = await response.json();

                if (result.success) {
                    showNotification('‚úÖ ' + result.message, 'success');
                    closeLocationModal();
                    await loadAllData();
                    updateAllPages();
                } else {
                    showNotification('‚ùå ' + result.message, 'error');
                }
            } catch (error) {
                console.error('Error saving location:', error);
                showNotification('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message, 'error');
            }

            hideLoading();
        }

        async function deleteLocation(locationName) {
            if (!confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà "' + locationName + '" ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                return;
            }

            showLoading();

            try {
                const response = await fetch(webAppUrl, {
                    method: 'POST',
                    body: JSON.stringify({
                        action: 'deleteLocation',
                        location: locationName
                    })
                });

                const result = await response.json();

                if (result.success) {
                    showNotification('‚úÖ ‡∏•‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
                    await loadAllData();
                    updateAllPages();
                } else {
                    showNotification('‚ùå ' + result.message, 'error');
                }
            } catch (error) {
                console.error('Error deleting location:', error);
                showNotification('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message, 'error');
            }

            hideLoading();
        }

        // ========================================
        // IMPORT EXCEL
        // ========================================
        function openImportModal() {
            document.getElementById('importModal').classList.add('active');
            document.getElementById('importProgress').style.display = 'none';
            document.getElementById('progressFill').style.width = '0%';
        }

        function closeImportModal() {
            document.getElementById('importModal').classList.remove('active');
            document.getElementById('excelFile').value = '';
        }

        async function handleFileSelect(event) {
            const file = event.target.files[0];
            if (!file) return;

            if (!file.name.endsWith('.xlsx') && !file.name.endsWith('.xls')) {
                showNotification('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå Excel (.xlsx, .xls)', 'warning');
                return;
            }

            document.getElementById('importProgress').style.display = 'block';
            document.getElementById('progressFill').style.width = '30%';
            document.getElementById('progressText').textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå...';

            try {
                const data = await file.arrayBuffer();
                const workbook = XLSX.read(data);
                const sheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[sheetName];
                const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });

                document.getElementById('progressFill').style.width = '60%';
                document.getElementById('progressText').textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';

                // Skip header row
                const rows = jsonData.slice(1);
                const assets = rows.map(row => ({
                    assetCode: row[0] || '',
                    assetName: row[1] || '',
                    category: row[2] || '',
                    brand: row[3] || '',
                    model: row[4] || '',
                    serial: row[5] || '',
                    receivedDate: row[6] || '',
                    price: row[7] || '',
                    location: row[8] || '',
                    department: row[9] || '',
                    status: row[10] || '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥',
                    description: row[11] || ''
                })).filter(asset => asset.assetCode);

                if (assets.length === 0) {
                    showNotification('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå', 'warning');
                    closeImportModal();
                    return;
                }

                document.getElementById('progressFill').style.width = '80%';
                document.getElementById('progressText').textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';

                // Send to server
                const response = await fetch(webAppUrl, {
                    method: 'POST',
                    body: JSON.stringify({
                        action: 'importAssets',
                        assets: assets
                    })
                });

                const result = await response.json();

                document.getElementById('progressFill').style.width = '100%';

                if (result.success) {
                    showNotification('‚úÖ ' + result.message, 'success');
                    closeImportModal();
                    await loadAllData();
                    updateAllPages();
                } else {
                    showNotification('‚ùå ' + result.message, 'error');
                }

            } catch (error) {
                console.error('Error importing:', error);
                showNotification('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ Import: ' + error.message, 'error');
            }

            document.getElementById('excelFile').value = '';
        }

        function downloadTemplate() {
            // Create template data
            const template = [
                ['‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô', '‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô', '‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà', '‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠', '‡∏£‡∏∏‡πà‡∏ô', 'Serial Number', '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤', '‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠', '‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö', '‡πÅ‡∏ú‡∏ô‡∏Å', '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞', '‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢'],
                ['AST-001', '‡πÇ‡∏ô‡πâ‡∏ï‡∏ö‡∏∏‡πä‡∏Ñ Dell', '‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå', 'Dell', 'Latitude 5420', 'SN123456', '01/01/2024', '25000', '‡∏´‡πâ‡∏≠‡∏á‡πÑ‡∏≠‡∏ó‡∏µ', 'IT Department', '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥', '‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏ü‡∏ü‡∏¥‡∏®'],
                ['AST-002', '‡πÄ‡∏Å‡πâ‡∏≤‡∏≠‡∏µ‡πâ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô', '‡πÄ‡∏ü‡∏≠‡∏£‡πå‡∏ô‡∏¥‡πÄ‡∏à‡∏≠‡∏£‡πå', 'Herman Miller', 'Aeron', '', '15/01/2024', '18000', '‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ‡∏ä‡∏±‡πâ‡∏ô 2', 'Admin', '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥', '']
            ];

            const ws = XLSX.utils.aoa_to_sheet(template);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Template');
            XLSX.writeFile(wb, 'Asset_Import_Template.xlsx');
        }

        // Drag and drop
        const dropZone = document.getElementById('dropZone');
        if (dropZone) {
            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropZone.classList.add('dragover');
            });

            dropZone.addEventListener('dragleave', () => {
                dropZone.classList.remove('dragover');
            });

            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropZone.classList.remove('dragover');
                
                const file = e.dataTransfer.files[0];
                if (file) {
                    const fileInput = document.getElementById('excelFile');
                    const dataTransfer = new DataTransfer();
                    dataTransfer.items.add(file);
                    fileInput.files = dataTransfer.files;
                    
                    // Trigger file select handler
                    handleFileSelect({ target: fileInput });
                }
            });
        }

        // ========================================
        // DEPARTMENT PAGE
        // ========================================
        function updateDepartmentPage() {
            const deptCounts = {};
            const deptStatus = {};

            assetsData.forEach(asset => {
                const dept = asset.department || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡πÅ‡∏ú‡∏ô‡∏Å';
                
                if (!deptCounts[dept]) {
                    deptCounts[dept] = 0;
                    deptStatus[dept] = {
                        active: 0,
                        maintenance: 0,
                        broken: 0
                    };
                }
                
                deptCounts[dept]++;
                
                if (asset.status === '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥') deptStatus[dept].active++;
                else if (asset.status === '‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á') deptStatus[dept].maintenance++;
                else if (asset.status === '‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏™‡∏†‡∏≤‡∏û') deptStatus[dept].broken++;
            });

            // Update stats
            document.getElementById('totalDepartments').textContent = Object.keys(deptCounts).length;
            
            let totalActive = 0, totalMaintenance = 0, totalBroken = 0;
            Object.values(deptStatus).forEach(status => {
                totalActive += status.active;
                totalMaintenance += status.maintenance;
                totalBroken += status.broken;
            });
            
            document.getElementById('deptActiveTotal').textContent = totalActive;
            document.getElementById('deptMaintenanceTotal').textContent = totalMaintenance;
            document.getElementById('deptBrokenTotal').textContent = totalBroken;

            // Update charts
            updateDepartmentCharts(deptCounts, deptStatus);
            renderDepartmentTable(deptStatus);
            renderDepartmentDetails(deptCounts);
        }

        function updateDepartmentCharts(deptCounts, deptStatus) {
            // Bar Chart
            const barCtx = document.getElementById('departmentBarChart');
            if (barCtx && !charts.departmentBar) {
                charts.departmentBar = new Chart(barCtx, {
                    type: 'bar',
                    data: {
                        labels: Object.keys(deptCounts),
                        datasets: [{
                            label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô',
                            data: Object.values(deptCounts),
                            backgroundColor: '#14b8a6'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            } else if (charts.departmentBar) {
                charts.departmentBar.data.labels = Object.keys(deptCounts);
                charts.departmentBar.data.datasets[0].data = Object.values(deptCounts);
                charts.departmentBar.update();
            }

            // Pie Chart
            const pieCtx = document.getElementById('departmentPieChart');
            if (pieCtx && !charts.departmentPie) {
                charts.departmentPie = new Chart(pieCtx, {
                    type: 'pie',
                    data: {
                        labels: Object.keys(deptCounts),
                        datasets: [{
                            data: Object.values(deptCounts),
                            backgroundColor: [
                                '#14b8a6', '#06b6d4', '#10b981', '#f59e0b', 
                                '#ef4444', '#8b5cf6', '#ec4899', '#6366f1'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            } else if (charts.departmentPie) {
                charts.departmentPie.data.labels = Object.keys(deptCounts);
                charts.departmentPie.data.datasets[0].data = Object.values(deptCounts);
                charts.departmentPie.update();
            }
        }

        function renderDepartmentTable(deptStatus) {
            const tbody = document.getElementById('departmentTableBody');
            
            if (Object.keys(deptStatus).length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" class="empty-state">
                            <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = Object.entries(deptStatus).map(([dept, status]) => {
                const total = status.active + status.maintenance + status.broken;
                return `
                    <tr>
                        <td><strong>${dept}</strong></td>
                        <td>${status.active}</td>
                        <td>${status.maintenance}</td>
                        <td>${status.broken}</td>
                        <td>0</td>
                        <td><strong>${total}</strong></td>
                        <td>
                            <button class="action-btn action-edit" onclick="viewDepartmentAssets('${dept}')">
                                <i class="fas fa-eye"></i>
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function renderDepartmentDetails(deptCounts) {
            const container = document.getElementById('departmentDetails');
            
            if (Object.keys(deptCounts).length === 0) {
                container.innerHTML = '<div class="empty-state"><p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p></div>';
                return;
            }

            container.innerHTML = Object.entries(deptCounts)
                .sort((a, b) => b[1] - a[1])
                .map(([dept, count]) => `
                    <div style="padding: 12px; border-bottom: 1px solid #e5e7eb; display: flex; justify-content: space-between; align-items: center;">
                        <strong style="color: #333;">${dept}</strong>
                        <span style="background: #14b8a6; color: white; padding: 4px 12px; border-radius: 20px; font-size: 13px; font-weight: 600;">${count} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>
                    </div>
                `).join('');
        }

        function viewDepartmentAssets(department) {
            // Filter assets by department and show in assets page
            showPage('assets');
            document.getElementById('searchAsset').value = '';
            document.getElementById('filterCategory').value = '';
            document.getElementById('filterLocation').value = '';
            document.getElementById('filterStatus').value = '';
            
            filteredAssets = assetsData.filter(a => (a.department || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡πÅ‡∏ú‡∏ô‡∏Å') === department);
            renderAssets();
        }

        function refreshDepartments() {
            console.log('üîÑ Refreshing department data...');
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏´‡∏°‡∏∏‡∏ô
            const refreshIcon = event.target.querySelector('.fa-sync-alt');
            if (refreshIcon) {
                refreshIcon.classList.add('fa-spin');
            }
            
            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            updateDepartmentPage();
            
            showNotification('‚úÖ ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ú‡∏ô‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡πÅ‡∏ú‡∏ô‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: ' + document.getElementById('totalDepartments').textContent, 'success');
            
            // ‡∏•‡∏ö‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å 0.5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
            setTimeout(() => {
                if (refreshIcon) {
                    refreshIcon.classList.remove('fa-spin');
                }
            }, 500);
            
            console.log('‚úÖ Department data refreshed');
        }

        // ========================================
        // MAINTENANCE PAGE
        // ========================================
        function updateMaintenancePage() {
            const maintenanceAssets = assetsData.filter(a => a.status === '‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á');
            const activeAssets = assetsData.filter(a => a.status === '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥');
            
            document.getElementById('maintenanceCount').textContent = maintenanceAssets.length;
            document.getElementById('inProgressCount').textContent = maintenanceAssets.length;
            document.getElementById('completedCount').textContent = activeAssets.length;
            
            // Calculate estimated cost (placeholder - adjust as needed)
            const estimatedCost = maintenanceAssets.reduce((sum, asset) => {
                const price = parseFloat(asset.price) || 0;
                return sum + (price * 0.1); // Assume 10% of asset price as maintenance cost
            }, 0);
            
            document.getElementById('estimatedCost').textContent = '‡∏ø' + estimatedCost.toLocaleString();

            // Render maintenance table
            renderMaintenanceTable(maintenanceAssets);
        }

        function renderMaintenanceTable(maintenanceAssets) {
            const tbody = document.getElementById('maintenanceTableBody');
            
            if (maintenanceAssets.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" class="empty-state">
                            <i class="fas fa-tools"></i>
                            <h3>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á</h3>
                            <p>‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ "‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á" ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</p>
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = maintenanceAssets.map((asset, index) => `
                <tr>
                    <td>${index + 1}</td>
                    <td><strong>${asset.assetCode}</strong></td>
                    <td>${asset.assetName}</td>
                    <td>${asset.department || '-'}</td>
                    <td><span class="status-badge status-maintenance">${asset.status}</span></td>
                    <td>${formatDateTime(asset.lastUpdate)}</td>
                    <td>
                        <button class="action-btn action-edit" onclick='editAsset(${JSON.stringify(asset).replace(/'/g, "&#39;")})'>
                            <i class="fas fa-edit"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function refreshMaintenance() {
            console.log('üîÑ Refreshing maintenance data...');
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏´‡∏°‡∏∏‡∏ô
            const refreshIcon = event.target.querySelector('.fa-sync-alt');
            if (refreshIcon) {
                refreshIcon.classList.add('fa-spin');
            }
            
            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            updateMaintenancePage();
            
            const maintenanceCount = document.getElementById('maintenanceCount').textContent;
            showNotification('‚úÖ ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°: ' + maintenanceCount, 'success');
            
            // ‡∏•‡∏ö‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å 0.5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
            setTimeout(() => {
                if (refreshIcon) {
                    refreshIcon.classList.remove('fa-spin');
                }
            }, 500);
            
            console.log('‚úÖ Maintenance data refreshed');
        }

        // ========================================
        // REPORTS PAGE
        // ========================================
        function updateReportsPage() {
            document.getElementById('reportTotalAssets').textContent = assetsData.length;
            
            const departments = new Set(assetsData.map(a => a.department).filter(Boolean));
            document.getElementById('reportTotalDepartments').textContent = departments.size;
            
            document.getElementById('reportTotalLocations').textContent = locationsData.length;
            
            const categories = new Set(assetsData.map(a => a.category).filter(Boolean));
            document.getElementById('reportTotalCategories').textContent = categories.size;

            // Update all report charts
            updateReportCharts();
        }

        function updateReportCharts() {
            initReportStatusChart();
            initReportCategoryChart();
            initReportDepartmentChart();
            initReportLocationChart();
            initReportValueByDeptChart();
            initReportValueByStatusChart();
            initReportCapacityChart();
        }

        function initReportStatusChart() {
            const ctx = document.getElementById('reportStatusChart');
            if (!ctx) return;

            const active = assetsData.filter(a => a.status === '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥').length;
            const maintenance = assetsData.filter(a => a.status === '‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á').length;
            const broken = assetsData.filter(a => a.status === '‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏™‡∏†‡∏≤‡∏û').length;

            if (charts.reportStatus) {
                charts.reportStatus.destroy();
            }

            charts.reportStatus = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥', '‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á', '‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏™‡∏†‡∏≤‡∏û'],
                    datasets: [{
                        data: [active, maintenance, broken],
                        backgroundColor: ['#10b981', '#06b6d4', '#f59e0b'],
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 15,
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.parsed || 0;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((value / total) * 100).toFixed(1);
                                    return `${label}: ${value} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function initReportCategoryChart() {
            const ctx = document.getElementById('reportCategoryChart');
            if (!ctx) return;

            const categoryCounts = {};
            assetsData.forEach(asset => {
                const cat = asset.category || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏';
                categoryCounts[cat] = (categoryCounts[cat] || 0) + 1;
            });

            // Sort by count and take top 10
            const sortedCategories = Object.entries(categoryCounts)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);

            if (charts.reportCategory) {
                charts.reportCategory.destroy();
            }

            charts.reportCategory = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: sortedCategories.map(c => c[0]),
                    datasets: [{
                        label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô',
                        data: sortedCategories.map(c => c[1]),
                        backgroundColor: '#14b8a6',
                        borderRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                precision: 0
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        function initReportDepartmentChart() {
            const ctx = document.getElementById('reportDepartmentChart');
            if (!ctx) return;

            const deptCounts = {};
            assetsData.forEach(asset => {
                const dept = asset.department || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏';
                deptCounts[dept] = (deptCounts[dept] || 0) + 1;
            });

            // Sort and take top 10
            const sortedDepts = Object.entries(deptCounts)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);

            if (charts.reportDepartment) {
                charts.reportDepartment.destroy();
            }

            charts.reportDepartment = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: sortedDepts.map(d => d[0]),
                    datasets: [{
                        label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô',
                        data: sortedDepts.map(d => d[1]),
                        backgroundColor: '#06b6d4',
                        borderRadius: 5
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: true,
                    scales: {
                        x: {
                            beginAtZero: true,
                            ticks: {
                                precision: 0
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        function initReportLocationChart() {
            const ctx = document.getElementById('reportLocationChart');
            if (!ctx) return;

            const locationCounts = {};
            assetsData.forEach(asset => {
                const loc = asset.location || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏';
                locationCounts[loc] = (locationCounts[loc] || 0) + 1;
            });

            // Sort and take top 10
            const sortedLocations = Object.entries(locationCounts)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);

            if (charts.reportLocation) {
                charts.reportLocation.destroy();
            }

            charts.reportLocation = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: sortedLocations.map(l => l[0]),
                    datasets: [{
                        label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô',
                        data: sortedLocations.map(l => l[1]),
                        backgroundColor: '#10b981',
                        borderRadius: 5
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: true,
                    scales: {
                        x: {
                            beginAtZero: true,
                            ticks: {
                                precision: 0
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        function initReportValueByDeptChart() {
            const ctx = document.getElementById('reportValueByDeptChart');
            if (!ctx) return;

            const deptValues = {};
            assetsData.forEach(asset => {
                const dept = asset.department || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏';
                const price = parseFloat(asset.price) || 0;
                deptValues[dept] = (deptValues[dept] || 0) + price;
            });

            // Sort and take top 10
            const sortedDepts = Object.entries(deptValues)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);

            if (charts.reportValueByDept) {
                charts.reportValueByDept.destroy();
            }

            charts.reportValueByDept = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: sortedDepts.map(d => d[0]),
                    datasets: [{
                        label: '‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤ (‡∏ö‡∏≤‡∏ó)',
                        data: sortedDepts.map(d => d[1]),
                        backgroundColor: '#f59e0b',
                        borderRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '‡∏ø' + value.toLocaleString();
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return '‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤: ‡∏ø' + context.parsed.y.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }

        function initReportValueByStatusChart() {
            const ctx = document.getElementById('reportValueByStatusChart');
            if (!ctx) return;

            const statusValues = {
                '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥': 0,
                '‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á': 0,
                '‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏™‡∏†‡∏≤‡∏û': 0
            };

            assetsData.forEach(asset => {
                const status = asset.status || '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥';
                const price = parseFloat(asset.price) || 0;
                if (statusValues[status] !== undefined) {
                    statusValues[status] += price;
                }
            });

            if (charts.reportValueByStatus) {
                charts.reportValueByStatus.destroy();
            }

            charts.reportValueByStatus = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: Object.keys(statusValues),
                    datasets: [{
                        data: Object.values(statusValues),
                        backgroundColor: ['#10b981', '#06b6d4', '#f59e0b'],
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 15,
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.parsed || 0;
                                    return `${label}: ‡∏ø${value.toLocaleString()}`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function initReportCapacityChart() {
            const ctx = document.getElementById('reportCapacityChart');
            if (!ctx) return;

            const capacityData = locationsData.map(loc => {
                const capacity = parseInt(loc.maxCapacity) || 0;
                const count = parseInt(loc.assetCount) || 0;
                const percent = capacity > 0 ? Math.round((count / capacity) * 100) : 0;
                return {
                    name: loc.name,
                    percent: percent
                };
            }).sort((a, b) => b.percent - a.percent);

            if (charts.reportCapacity) {
                charts.reportCapacity.destroy();
            }

            charts.reportCapacity = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: capacityData.map(d => d.name),
                    datasets: [{
                        label: '‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (%)',
                        data: capacityData.map(d => d.percent),
                        backgroundColor: capacityData.map(d => {
                            if (d.percent >= 90) return '#ef4444';
                            if (d.percent >= 70) return '#f59e0b';
                            return '#10b981';
                        }),
                        borderRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return '‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô: ' + context.parsed.y + '%';
                                }
                            }
                        }
                    }
                }
            });
        }

        function exportAssetsReport() {
            if (assetsData.length === 0) {
                showNotification('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ Export', 'warning');
                return;
            }

            const data = assetsData.map(asset => ({
                '‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô': asset.assetCode,
                '‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô': asset.assetName,
                '‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà': asset.category || '',
                '‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠': asset.brand || '',
                '‡∏£‡∏∏‡πà‡∏ô': asset.model || '',
                'Serial Number': asset.serial || '',
                '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤': asset.receivedDate || '',
                '‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠': asset.price || '',
                '‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö': asset.location || '',
                '‡πÅ‡∏ú‡∏ô‡∏Å': asset.department || '',
                '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞': asset.status,
                '‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢': asset.description || '',
                '‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î': asset.lastUpdate || ''
            }));

            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Assets');
            
            const date = new Date().toISOString().split('T')[0];
            XLSX.writeFile(wb, `Assets_Report_${date}.xlsx`);

            showNotification('‚úÖ Export ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
        }

        function exportLocationReport() {
            if (locationsData.length === 0) {
                showNotification('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ Export', 'warning');
                return;
            }

            const data = locationsData.map(loc => ({
                '‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà': loc.name,
                '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∏‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î': loc.maxCapacity || '',
                '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô': loc.assetCount || 0,
                '% ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∏': loc.maxCapacity ? Math.round((loc.assetCount / loc.maxCapacity) * 100) + '%' : '-',
                '‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏≠‡∏á': loc.customData || '',
                '‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î': loc.lastUpdate || ''
            }));

            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Locations');
            
            const date = new Date().toISOString().split('T')[0];
            XLSX.writeFile(wb, `Locations_Report_${date}.xlsx`);

            showNotification('‚úÖ Export ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
        }

        function exportMaintenanceReport() {
            const maintenanceAssets = assetsData.filter(a => a.status === '‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á');
            
            if (maintenanceAssets.length === 0) {
                showNotification('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡πÉ‡∏´‡πâ Export', 'warning');
                return;
            }

            const data = maintenanceAssets.map(asset => ({
                '‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô': asset.assetCode,
                '‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô': asset.assetName,
                '‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà': asset.category || '',
                '‡πÅ‡∏ú‡∏ô‡∏Å': asset.department || '',
                '‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö': asset.location || '',
                '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞': asset.status,
                '‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î': asset.lastUpdate || ''
            }));

            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Maintenance');
            
            const date = new Date().toISOString().split('T')[0];
            XLSX.writeFile(wb, `Maintenance_Report_${date}.xlsx`);

            showNotification('‚úÖ Export ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
        }

        function exportDepartmentReport() {
            const deptCounts = {};
            const deptStatus = {};

            assetsData.forEach(asset => {
                const dept = asset.department || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡πÅ‡∏ú‡∏ô‡∏Å';
                
                if (!deptCounts[dept]) {
                    deptCounts[dept] = 0;
                    deptStatus[dept] = {
                        active: 0,
                        maintenance: 0,
                        broken: 0
                    };
                }
                
                deptCounts[dept]++;
                
                if (asset.status === '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥') deptStatus[dept].active++;
                else if (asset.status === '‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á') deptStatus[dept].maintenance++;
                else if (asset.status === '‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏™‡∏†‡∏≤‡∏û') deptStatus[dept].broken++;
            });

            const data = Object.entries(deptStatus).map(([dept, status]) => ({
                '‡πÅ‡∏ú‡∏ô‡∏Å': dept,
                '‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå': status.active,
                '‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°': status.maintenance,
                '‡∏ä‡∏≥‡∏£‡∏∏‡∏î': status.broken,
                '‡∏£‡∏ß‡∏°': status.active + status.maintenance + status.broken
            }));

            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Departments');
            
            const date = new Date().toISOString().split('T')[0];
            XLSX.writeFile(wb, `Department_Report_${date}.xlsx`);

            showNotification('‚úÖ Export ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
        }

        // ========================================
        // UTILITY FUNCTIONS
        // ========================================
        function formatDateTime(dateTime) {
            if (!dateTime) return '-';
            
            try {
                const date = typeof dateTime === 'string' ? new Date(dateTime) : dateTime;
                
                if (isNaN(date.getTime())) return dateTime;
                
                const day = String(date.getDate()).padStart(2, '0');
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const year = date.getFullYear() + 543;
                const hours = String(date.getHours()).padStart(2, '0');
                const minutes = String(date.getMinutes()).padStart(2, '0');
                
                return `${day}/${month}/${year} ${hours}:${minutes}`;
            } catch (e) {
                return dateTime;
            }
        }

        function showLoading() {
            document.getElementById('loading').classList.add('active');
        }

        function hideLoading() {
            document.getElementById('loading').classList.remove('active');
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const content = document.getElementById('notificationContent');
            
            const icons = {
                success: '<i class="fas fa-check-circle"></i>',
                error: '<i class="fas fa-times-circle"></i>',
                warning: '<i class="fas fa-exclamation-triangle"></i>'
            };
            
            content.innerHTML = `
                <div style="display: flex; align-items: center; gap: 12px;">
                    <div style="font-size: 24px;">${icons[type] || icons.success}</div>
                    <div style="flex: 1;">${message}</div>
                </div>
            `;
            
            notification.className = 'notification active ' + type;
            
            setTimeout(() => {
                notification.classList.remove('active');
            }, 4000);
        }

        // Close modal on outside click
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('active');
            }
        };

        // Responsive handling
        window.addEventListener('resize', function() {
            if (window.innerWidth > 768) {
                const sidebar = document.getElementById('sidebar');
                sidebar.classList.remove('mobile-open');
                sidebar.classList.remove('mobile-hidden');
            } else {
                const sidebar = document.getElementById('sidebar');
                if (!sidebar.classList.contains('mobile-open')) {
                    sidebar.classList.add('mobile-hidden');
                }
            }
        });

        // Initialize responsive state
        if (window.innerWidth <= 768) {
            document.getElementById('sidebar').classList.add('mobile-hidden');
        }
    </script>
</body>
</html>
